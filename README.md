# üîß StatForge

<p align="center">
  <img src="https://img.shields.io/badge/Unity-6000.0.54f1+-blue?logo=unity" alt="Unity Version">
  <img src="https://img.shields.io/badge/License-MIT-green" alt="License">
  <img src="https://img.shields.io/badge/Version-0.2.0-orange" alt="Version">
</p>

**StatForge** √© um sistema modular e poderoso para Unity que permite criar, gerenciar e manipular atributos (stats) de forma flex√≠vel e eficiente. Ideal para RPGs, jogos de estrat√©gia, simuladores e qualquer projeto que precise de um sistema robusto de caracter√≠sticas.

## ‚ú® Principais Caracter√≠sticas

- üéØ **API Ultra-Simplificada**: Apenas `[Stat]` e funciona!
- üìä **Sintaxe Natural**: `Health -= Time.deltaTime;` funciona como esperado
- üîß **Editor Visual Moderno**: Interface limpa sem elementos desnecess√°rios
- üì¶ **Sistema Modular**: Use com ou sem MonoBehaviour
- üéõÔ∏è **Query System Fluente**: `stats.Where().Sum()` para consultas complexas
- ‚ö° **Performance Otimizada**: Cache inteligente e zero allocations
- üîÑ **Modificadores Tempor√°rios**: Buffs e debuffs com dura√ß√£o autom√°tica
- üìã **Compatibilidade Total**: Funciona com sistema tradicional
- üéØ **Auto-Discovery**: Detecta automaticamente campos marcados com `[Stat]`
- üîß **Thread-Safe**: Cole√ß√µes seguras para uso em m√∫ltiplas threads

## üì• Instala√ß√£o

### Via Package Manager (Recomendado)

1. Abra o Package Manager (`Window > Package Manager`)
2. Clique no bot√£o **+** no canto superior esquerdo
3. Selecione **"Add package from git URL..."**
4. Digite a URL: `https://github.com/Natteens/statforge.git`
5. Clique em **Add**

### Via manifest.json

Adicione ao arquivo `Packages/manifest.json` do seu projeto:

```json
{
  "dependencies": {
    "com.natteens.statforge": "https://github.com/Natteens/statforge.git"
  }
}
```

## üèóÔ∏è Arquitetura do Sistema

### Componentes Principais

```mermaid
graph TD
    A[AttributeSystem] --> B[StatContainer]
    B --> C[StatValue]
    C --> D[StatType]
    E[FormulaEvaluator] --> D
    F[StatForgeManager] --> A
    F --> B
    F --> G[ContainerTemplate]
```

#### üìä **StatType** - Defini√ß√£o de Atributos
Define as caracter√≠sticas base de um atributo:
- Nome de exibi√ß√£o e nome curto
- Categoria (Primary/Derived/External)
- Valores padr√£o, m√≠nimo e m√°ximo
- F√≥rmulas para stats derivados

#### üì¶ **StatContainer** - Agrupamento de Stats
Organiza e gerencia cole√ß√µes de stats:
- Auto-popula√ß√£o baseada em categorias
- Sistema de merge para combinar containers
- Rec√°lculo autom√°tico de depend√™ncias

#### üíé **StatValue** - Valor Atual
Representa o valor atual de um stat:
- Valor base + pontos alocados + b√¥nus
- Eventos de mudan√ßa de valor
- Suporte a modificadores

#### ‚öôÔ∏è **AttributeSystem** - Gerenciador Principal
Componente Unity que controla todo o sistema:
- Aloca√ß√£o de pontos
- Modificadores tempor√°rios
- Interface unificada de acesso

## üöÄ Guia de Uso R√°pido

### 1. API Ultra-Simplificada (Recomendado)

Agora voc√™ pode usar o StatForge com apenas uma linha! Adicione `[Stat]` aos seus campos:

```csharp
using StatForge;

public class Player : MonoBehaviour
{
    [Stat] public int Strength = 10;
    [Stat] public float Health = 100f;
    [Stat] public int Level = 1;
    
    void Update()
    {
        Health -= Time.deltaTime;  // Sintaxe natural!
        if (Input.GetKeyDown(KeyCode.Space)) Level++;
    }
}
```

### 2. Configura√ß√£o Avan√ßada com Atributos

Para mais controle, use par√¢metros no atributo `[Stat]`:

```csharp
public class AdvancedPlayer : MonoBehaviour
{
    [Stat(DisplayName = "For√ßa", ShortName = "STR", MinValue = 1, MaxValue = 100)]
    public int Strength = 10;
    
    [Stat(DisplayName = "Vida M√°xima", Formula = "STR * 10 + Level * 5", Category = StatCategory.Derived)]
    public float MaxHealth = 0f; // Auto-calculado
    
    [Stat] public float Health = 100f;
    [Stat] public int Level = 1;
}
```

### 3. Usando o Componente StatForge

O componente `StatForgeComponent` √© adicionado automaticamente e oferece funcionalidades extras:

```csharp
public class PlayerController : MonoBehaviour
{
    private StatForgeComponent statForge;
    
    void Start()
    {
        statForge = GetComponent<StatForgeComponent>();
        
        // Adicionar buff tempor√°rio
        statForge.AddModifier<int>("Strength", 5, 10f); // +5 por 10 segundos
        
        // Escutar mudan√ßas
        statForge.OnAttributeChanged("Health", (oldVal, newVal) => 
        {
            Debug.Log($"Health changed: {oldVal} ‚Üí {newVal}");
        });
        
        // Query system fluente
        var totalCombatPower = statForge.Query()
            .Where(name => name.Contains("Strength") || name.Contains("Attack"))
            .Sum<int>();
    }
}
```

### 4. M√©todo Tradicional (Compatibilidade)

O sistema tradicional continua funcionando para projetos existentes:

```csharp
using StatForge;

public class Character : MonoBehaviour
{
    [SerializeField] private AttributeSystem attributeSystem;
    
    void Start()
    {
        // Dar pontos para alocar
        attributeSystem.SetAvailablePoints(20);
        
        // Obter valor de um stat
        float strength = attributeSystem.GetStatValue(strengthStat);
        
        // Adicionar modificador tempor√°rio (buff)
        attributeSystem.AddTemporaryBonus(strengthStat, 5f);
        
        // Alocar ponto em um stat
        if (attributeSystem.CanAllocatePoint(strengthStat))
        {
            attributeSystem.AllocatePoint(strengthStat);
        }
    }
}
```

## üìù Sistema de F√≥rmulas

O StatForge suporta f√≥rmulas matem√°ticas complexas para calcular stats derivados:

### Operadores Suportados
- `+` Adi√ß√£o
- `-` Subtra√ß√£o
- `*` Multiplica√ß√£o
- `/` Divis√£o
- `()` Par√™nteses para agrupamento

### Refer√™ncias a Stats
Use o **Short Name** dos stats nas f√≥rmulas:

```csharp
// Exemplos de f√≥rmulas
"STR + DEX"                    // Soma simples
"(STR + CON) * 2"             // Com par√™nteses
"STR * 5 + CON * 3"           // Multiplica√ß√£o e soma
"25% STR + 75% DEX"           // Percentuais
```

### Exemplos Pr√°ticos

```csharp
// Health Points baseado em Constitui√ß√£o
Formula: "CON * 10 + 50"

// Dano f√≠sico baseado em For√ßa e Destreza
Formula: "STR * 2 + DEX * 0.5"

// Velocidade de movimento
Formula: "(DEX + AGI) / 2 + 5"

// Mana baseada em Intelig√™ncia
Formula: "INT * 15 + WIS * 5"
```

## üéÆ Casos de Uso Comuns

### RPG Cl√°ssico

```csharp
// Stats prim√°rios
Strength (STR) - Primary
Dexterity (DEX) - Primary  
Constitution (CON) - Primary
Intelligence (INT) - Primary
Wisdom (WIS) - Primary
Charisma (CHA) - Primary

// Stats derivados
Health Points: "CON * 10 + 50"
Mana Points: "INT * 8 + WIS * 2"
Attack Damage: "STR * 2 + DEX * 0.5"
Armor Class: "DEX + 10"
```

### Sistema de Habilidades

```csharp
// Container para cada habilidade
Swordsmanship Container:
- Base Damage: STR-based
- Critical Chance: DEX-based
- Skill Level: Allocated points

Magic Container:
- Spell Power: INT-based
- Mana Cost Reduction: WIS-based
- Spell Level: Allocated points
```

### Sistema de Equipamentos

```csharp
// Cada item tem seu pr√≥prio container
Sword Container:
- Attack Damage: +15
- Critical Chance: +5%

Heavy Armor Container:
- Defense: +20
- Movement Speed: -10%
```

## üõ†Ô∏è API Reference

### AttributeSystem

```csharp
// Gerenciamento de pontos
void SetAvailablePoints(int points)
void AddAvailablePoints(int points)
int AvailablePoints { get; }

// Aloca√ß√£o de pontos
bool CanAllocatePoint(StatType statType)
bool AllocatePoint(StatType statType)
bool CanDeallocatePoint(StatType statType)
bool DeallocatePoint(StatType statType)
void ResetAllocatedPoints()

// Obter valores
float GetStatValue(StatType statType)
List<StatValue> GetPrimaryStats()
List<StatValue> GetDerivedStats()
List<StatValue> GetExternalStats()

// Modificadores tempor√°rios
void AddTemporaryBonus(StatType statType, float bonus)
void RemoveTemporaryBonus(StatType statType, float bonus)
void SetTemporaryBonus(StatType statType, float bonus)
void ClearTemporaryBonuses()
float GetTemporaryBonus(StatType statType)
```

### StatContainer

```csharp
// Gerenciamento de stats
void AddStat(StatType statType, float baseValue = 0f)
bool RemoveStat(StatType statType)
StatValue GetStat(StatType statType)
StatValue GetOrCreateStat(StatType statType)
bool HasStat(StatType statType)

// Valores
float GetStatValue(StatType statType)
void SetAllocatedPoints(StatType statType, float points)
void SetBonusValue(StatType statType, float bonus)
void SetBaseValue(StatType statType, float baseValue)

// Opera√ß√µes avan√ßadas
static StatContainer Merge(params StatContainer[] containers)
void ForceRecalculate()
void Initialize()
```

## üé® Editor Features

### StatForge Manager
Interface visual completa acess√≠vel via `Tools > StatForge > Manager`:

- **Stat Types**: Criar e editar defini√ß√µes de stats
- **Containers**: Gerenciar cole√ß√µes de stats
- **Templates**: Criar templates reutiliz√°veis
- **Tests**: Ambiente de teste interativo

### Inspector Customizado
O `AttributeSystem` possui um inspector customizado que mostra:

- Pontos dispon√≠veis com controles de teste
- Lista de todos os stats com valores atuais
- Controles para alocar/desalocar pontos
- Campos para modificadores tempor√°rios

## üîß Configura√ß√£o Avan√ßada

### Auto-Popula√ß√£o
Configure containers para auto-popular com stats de determinadas categorias:

```csharp
container.SetAutoPopulateSettings(
    primary: true,    // Incluir stats prim√°rios
    derived: true,    // Incluir stats derivados  
    external: false   // Excluir stats externos
);
```

### Merge de Containers
Combine m√∫ltiplos containers em um s√≥:

```csharp
var playerContainer = StatContainer.Merge(
    baseStatsContainer,
    classStatsContainer, 
    equipmentContainer
);
```

### Templates
Use templates para criar containers padronizados:

```csharp
// Criar template no editor
var warriorTemplate = CreateTemplate("Warrior", new[] {
    strengthStat, constitutionStat, armorStat, healthStat
});

// Usar template
var warriorContainer = CreateContainerFromTemplate(warriorTemplate);
```

## üéØ Melhores Pr√°ticas

### Organiza√ß√£o de Assets
```
Assets/
‚îú‚îÄ‚îÄ Stats/
‚îÇ   ‚îú‚îÄ‚îÄ Primary/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ Strength.asset
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ Dexterity.asset
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ Constitution.asset
‚îÇ   ‚îú‚îÄ‚îÄ Derived/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ HealthPoints.asset
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ AttackDamage.asset
‚îÇ   ‚îî‚îÄ‚îÄ Containers/
‚îÇ       ‚îú‚îÄ‚îÄ BaseCharacter.asset
‚îÇ       ‚îú‚îÄ‚îÄ WarriorClass.asset
‚îÇ       ‚îî‚îÄ‚îÄ MageClass.asset
```

### Performance
- Use o cache de lookup dos containers
- Evite rec√°lculos desnecess√°rios
- Agrupe stats relacionados em containers separados

### Design de F√≥rmulas
- Mantenha f√≥rmulas simples e leg√≠veis
- Use nomes curtos descritivos para stats
- Teste f√≥rmulas no ambiente de teste do editor

## üêõ Resolu√ß√£o de Problemas

### F√≥rmulas N√£o Funcionam
- Verifique se os Short Names est√£o corretos
- Confirme que n√£o h√° refer√™ncias circulares
- Use o ambiente de teste para debugar

### Stats N√£o Aparecem
- Verifique as configura√ß√µes de auto-popula√ß√£o
- Confirme que o container foi inicializado
- Verifique se os stats est√£o na categoria correta

### Performance Baixa
- Evite muitas depend√™ncias entre stats
- Use containers separados para sistemas independentes
- Cache valores que n√£o mudam frequentemente

---

<p align="center">
  Feito por Natte (Natteens) üòé
</p>